1. n = Read Integer Input
2. t = [0] + List of Integers from Input
3. a = [0] + List of Integers from Input
4. Initialize ans as an empty list
5. Initialize cnt as a list of zeros of size n+1
6. For each element i in a:
   6.1. Increment cnt[i] by 1
7. For i from 1 to n:
   7.1. If t[i] equals 1:
      7.1.1. Initialize crt as a list containing i
      7.1.2. x = a[i]
      7.1.3. While cnt[x] equals 1:
         7.1.3.1. Append x to crt
         7.1.3.2. x = a[x]
      7.1.4. If length of crt is greater than length of ans:
         7.1.4.1. Update ans with a copy of crt
8. Reverse the elements of ans
9. Print the length of ans
10. Print the elements of ans separated by spaces
